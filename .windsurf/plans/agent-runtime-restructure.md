# Agent Runtime Folder Restructure

Reorganize `agent_runtime/` to separate rules, templates, and per-idea artifacts.

---

## Proposed Structure

```
agent_runtime/
├── status.json                    # Workflow state (root)
├── status_history.csv             # Transition log (root)
├── ideas.md                       # Ideas log (root)
├── plugin/
│   └── context.md                 # Active idea context
│
├── rules/                         # Static governance docs
│   ├── git_protocol.md
│   ├── workflow_protocol.md
│   └── structure_rules.md
│
├── templates/                     # Output structure templates
│   ├── requirements.md
│   ├── acceptance_contract.md
│   ├── architecture.md
│   ├── assumptions.md
│   ├── backend_notes.md
│   ├── backend_test_report.md
│   ├── frontend_notes.md
│   ├── frontend_test_report.md
│   ├── test_report.md
│   ├── security_report.md
│   ├── to_development.md
│   ├── open_questions.md
│   └── comms_bootstrap_report.md
│
└── artifacts_history/
    └── {idea_id}/                 # Per-idea artifacts
        ├── requirements.md
        ├── acceptance_contract.md
        ├── architecture.md
        ├── assumptions.md
        ├── decisions.md
        ├── open_questions.md
        ├── backend_notes.md
        ├── backend_test_report.md
        ├── frontend_notes.md
        ├── frontend_test_report.md
        ├── test_report.md
        ├── security_report.md
        ├── change_log.md
        ├── runbook.md
        ├── to_development.md
        └── ci_*.md
```

---

## File Classification

### RULES (static governance - `rules/`)
| File | Purpose |
|------|---------|
| `git_protocol.md` | Git commit/branch rules for all agents |
| `workflow_protocol.md` | SDLC phase/actor transition rules |
| `structure_rules.md` | Folder structure and refactor policy |

### TEMPLATES (output structure - `templates/`)
| File | Purpose |
|------|---------|
| `requirements.md` | Template for system_analyst output |
| `acceptance_contract.md` | Template for AC-xx definitions |
| `architecture.md` | Template for architect output |
| `assumptions.md` | Template for assumptions log |
| `backend_notes.md` | Template for backend agent notes |
| `backend_test_report.md` | Template for backend tester output |
| `frontend_notes.md` | Template for frontend agent notes |
| `frontend_test_report.md` | Template for frontend tester output |
| `test_report.md` | Template for integration tester output |
| `security_report.md` | Template for security agent output |
| `to_development.md` | Template for architect handoff |
| `open_questions.md` | Template for unresolved questions |
| `comms_bootstrap_report.md` | Template for comms setup report |

### ARTIFACTS (per-idea generated - `artifacts_history/{idea}/`)

**Only files generated by agents that work on the idea exist.** Not all ideas have all files.

| File | Generated By | When Created |
|------|--------------|--------------|
| `requirements.md` | system_analyst | requirements phase |
| `acceptance_contract.md` | system_analyst | requirements phase |
| `assumptions.md` | system_analyst | requirements phase |
| `open_questions.md` | any agent | as needed |
| `decisions.md` | any agent | as needed (D-xx entries) |
| `architecture.md` | architect | architecture phase |
| `to_development.md` | architect_reviewer | architecture phase (on approval) |
| `runbook.md` | devops | devops phase |
| `backend_notes.md` | backend | backend phase |
| `backend_test_report.md` | backend_tester | backend_testing phase |
| `frontend_notes.md` | frontend | frontend phase |
| `frontend_test_report.md` | frontend_tester | frontend_testing phase |
| `test_report.md` | integration_tester | integration_testing phase |
| `security_report.md` | security | security phase |
| `change_log.md` | all agents | throughout workflow |
| `ci_*.md` | devops | devops phase |

**Example:** An idea that only needs backend work might only have:
- `requirements.md`, `acceptance_contract.md`, `architecture.md`
- `backend_notes.md`, `backend_test_report.md`
- `change_log.md`, `decisions.md`

---

## Current Files → New Location

| Current Path | New Path | Type |
|--------------|----------|------|
| `docs/git_protocol.md` | `rules/git_protocol.md` | Rule |
| `docs/workflow_protocol.md` | `rules/workflow_protocol.md` | Rule |
| `docs/structure_rules.md` | `rules/structure_rules.md` | Rule |
| `docs/templates/*` | `templates/*` | Template |
| `docs/requirements.md` | `artifacts_history/{idea}/requirements.md` | Artifact |
| `docs/acceptance_contract.md` | `artifacts_history/{idea}/acceptance_contract.md` | Artifact |
| `docs/architecture.md` | `artifacts_history/{idea}/architecture.md` | Artifact |
| ... (all other docs) | `artifacts_history/{idea}/...` | Artifact |

---

## Workflow Updates Needed

After restructure, update all `.windsurf/workflows/*.md` to use:
- `agent_runtime/rules/` for protocols
- `agent_runtime/templates/` for output templates
- `agent_runtime/artifacts_history/{idea}/` for generated artifacts
